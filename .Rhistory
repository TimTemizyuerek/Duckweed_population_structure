points(2, mean(lemna_p14[lower.tri(lemna_p14, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(3, mean(lemna_p19[lower.tri(lemna_p19, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(4, mean(lemna_p27[lower.tri(lemna_p27, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(5, mean(lemna_p36[lower.tri(lemna_p36, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_mean, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_mean, probs = c(0.001, 0.999)))
close.screen(4)
## diversity plot
par(mar=c(0,0,0,0),oma=c(3,3,3,3))
screen(5)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3), xlab="", main="", xaxt = "n",  yaxt="n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, diversity(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, diversity(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, diversity(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, diversity(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_diversity, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_diversity, probs = c(0.001, 0.999)))
close.screen(5)
## clones plot
par(mar=c(0,0,0,0),oma=c(3,3,3,3))
screen(6)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", yaxt="n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, ncol(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, ncol(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, ncol(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, ncol(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_clone, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_clone, probs = c(0.001, 0.999)))
close.screen(6)
## FIGURE 3: within vs outside distance ####
## number of iterations
iter = 1000
## set screens
split.screen(rbind(c(0, 0.5, 0.66, 1),
c(0, 0.5, 0.33, 0.66),
c(0, 0.5, 0, 0.33),
c(0.5, 1, 0.66, 1),
c(0.5, 1, 0.33, 0.66),
c(0.5, 1, 0, 0.33)))
## LANDOLTIA
## subset the ponds
landoltia_p10 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P10"),which(substr(colnames(landoltia_hamdist),1,3) == "P10")]
landoltia_p14 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P14"),which(substr(colnames(landoltia_hamdist),1,3) == "P14")]
landoltia_p19 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P19"),which(substr(colnames(landoltia_hamdist),1,3) == "P19")]
landoltia_p27 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P27"),which(substr(colnames(landoltia_hamdist),1,3) == "P27")]
landoltia_p36 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P36"),which(substr(colnames(landoltia_hamdist),1,3) == "P36")]
## calculate permutations
landoltia_perm_mean = vector()
landoltia_perm_clone = vector()
landoltia_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(landoltia_hamdist), 22)
runner_matrix = landoltia_hamdist[runner_sample,runner_sample]
landoltia_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
landoltia_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
landoltia_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,2,0.3,0.3),oma=c(3,3,3,3))
screen(1)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", ylab="Genetic distance", las=2)
points(1, mean(landoltia_p10[lower.tri(landoltia_p10, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(2, mean(landoltia_p14[lower.tri(landoltia_p14, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(3, mean(landoltia_p19[lower.tri(landoltia_p19, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(4, mean(landoltia_p27[lower.tri(landoltia_p27, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(5, mean(landoltia_p36[lower.tri(landoltia_p36, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_mean, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_mean, probs = c(0.001, 0.999)))
close.screen(1)
## diversity plot
par(mar=c(0.3,2,0.3,0.3),oma=c(3,3,3,3))
screen(2)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3), xlab="", main="", xaxt = "n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, diversity(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, diversity(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, diversity(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, diversity(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_diversity, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_diversity, probs = c(0.001, 0.999)))
close.screen(2)
## clones plot
par(mar=c(0.3,2,0.3,0.3),oma=c(3,3,3,3))
screen(3)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, ncol(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, ncol(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, ncol(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, ncol(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_clone, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_clone, probs = c(0.001, 0.999)))
close.screen(3)
## LEMNA
## subset the ponds
lemna_p10 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P10"),which(substr(colnames(lemna_hamdist),1,3) == "P10")]
lemna_p14 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P14"),which(substr(colnames(lemna_hamdist),1,3) == "P14")]
lemna_p19 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P19"),which(substr(colnames(lemna_hamdist),1,3) == "P19")]
lemna_p27 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P27"),which(substr(colnames(lemna_hamdist),1,3) == "P27")]
lemna_p36 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P36"),which(substr(colnames(lemna_hamdist),1,3) == "P36")]
## calculate permutations
lemna_perm_mean = vector()
lemna_perm_clone = vector()
lemna_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(lemna_hamdist), 22)
runner_matrix = lemna_hamdist[runner_sample,runner_sample]
lemna_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
lemna_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
lemna_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,0.3,0.3,0.3),oma=c(3,3,3,3))
screen(4)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", yaxt="n", ylab="Genetic distance", las=2)
points(1, mean(lemna_p10[lower.tri(lemna_p10, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(2, mean(lemna_p14[lower.tri(lemna_p14, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(3, mean(lemna_p19[lower.tri(lemna_p19, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(4, mean(lemna_p27[lower.tri(lemna_p27, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(5, mean(lemna_p36[lower.tri(lemna_p36, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_mean, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_mean, probs = c(0.001, 0.999)))
close.screen(4)
## diversity plot
par(mar=c(0.3,0.3,0.3,0.3),oma=c(3,3,3,3))
screen(5)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3), xlab="", main="", xaxt = "n",  yaxt="n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, diversity(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, diversity(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, diversity(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, diversity(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_diversity, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_diversity, probs = c(0.001, 0.999)))
close.screen(5)
## clones plot
par(mar=c(0.3,0.3,0.3,0.3),oma=c(3,3,3,3))
screen(6)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", yaxt="n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, ncol(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, ncol(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, ncol(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, ncol(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_clone, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_clone, probs = c(0.001, 0.999)))
close.screen(6)
## FIGURE 3: within vs outside distance ####
## number of iterations
iter = 1000
## set screens
split.screen(rbind(c(0, 0.5, 0.66, 1),
c(0, 0.5, 0.33, 0.66),
c(0, 0.5, 0, 0.33),
c(0.5, 1, 0.66, 1),
c(0.5, 1, 0.33, 0.66),
c(0.5, 1, 0, 0.33)))
## LANDOLTIA
## subset the ponds
landoltia_p10 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P10"),which(substr(colnames(landoltia_hamdist),1,3) == "P10")]
landoltia_p14 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P14"),which(substr(colnames(landoltia_hamdist),1,3) == "P14")]
landoltia_p19 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P19"),which(substr(colnames(landoltia_hamdist),1,3) == "P19")]
landoltia_p27 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P27"),which(substr(colnames(landoltia_hamdist),1,3) == "P27")]
landoltia_p36 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P36"),which(substr(colnames(landoltia_hamdist),1,3) == "P36")]
## calculate permutations
landoltia_perm_mean = vector()
landoltia_perm_clone = vector()
landoltia_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(landoltia_hamdist), 22)
runner_matrix = landoltia_hamdist[runner_sample,runner_sample]
landoltia_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
landoltia_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
landoltia_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,2,0.3,0.3),oma=c(3,3,3,3))
screen(1)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", ylab="Genetic distance", las=2)
points(1, mean(landoltia_p10[lower.tri(landoltia_p10, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(2, mean(landoltia_p14[lower.tri(landoltia_p14, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(3, mean(landoltia_p19[lower.tri(landoltia_p19, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(4, mean(landoltia_p27[lower.tri(landoltia_p27, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(5, mean(landoltia_p36[lower.tri(landoltia_p36, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_mean, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_mean, probs = c(0.001, 0.999)))
close.screen(1)
## diversity plot
par(mar=c(0.3,2,0.3,0.3),oma=c(3,3,3,3))
screen(2)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3.1), xlab="", main="", xaxt = "n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, diversity(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, diversity(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, diversity(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, diversity(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_diversity, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_diversity, probs = c(0.001, 0.999)))
close.screen(2)
## clones plot
par(mar=c(0.3,2,0.3,0.3),oma=c(3,3,3,3))
screen(3)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, ncol(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, ncol(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, ncol(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, ncol(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_clone, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_clone, probs = c(0.001, 0.999)))
close.screen(3)
## LEMNA
## subset the ponds
lemna_p10 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P10"),which(substr(colnames(lemna_hamdist),1,3) == "P10")]
lemna_p14 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P14"),which(substr(colnames(lemna_hamdist),1,3) == "P14")]
lemna_p19 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P19"),which(substr(colnames(lemna_hamdist),1,3) == "P19")]
lemna_p27 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P27"),which(substr(colnames(lemna_hamdist),1,3) == "P27")]
lemna_p36 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P36"),which(substr(colnames(lemna_hamdist),1,3) == "P36")]
## calculate permutations
lemna_perm_mean = vector()
lemna_perm_clone = vector()
lemna_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(lemna_hamdist), 22)
runner_matrix = lemna_hamdist[runner_sample,runner_sample]
lemna_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
lemna_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
lemna_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,0.3,0.3,0.3),oma=c(3,3,3,3))
screen(4)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", yaxt="n", ylab="Genetic distance", las=2)
points(1, mean(lemna_p10[lower.tri(lemna_p10, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(2, mean(lemna_p14[lower.tri(lemna_p14, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(3, mean(lemna_p19[lower.tri(lemna_p19, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(4, mean(lemna_p27[lower.tri(lemna_p27, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(5, mean(lemna_p36[lower.tri(lemna_p36, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_mean, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_mean, probs = c(0.001, 0.999)))
close.screen(4)
## diversity plot
par(mar=c(0.3,0.3,0.3,0.3),oma=c(3,3,3,3))
screen(5)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3.1), xlab="", main="", xaxt = "n",  yaxt="n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, diversity(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, diversity(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, diversity(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, diversity(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_diversity, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_diversity, probs = c(0.001, 0.999)))
close.screen(5)
## clones plot
par(mar=c(0.3,0.3,0.3,0.3),oma=c(3,3,3,3))
screen(6)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", yaxt="n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, ncol(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, ncol(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, ncol(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, ncol(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_clone, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_clone, probs = c(0.001, 0.999)))
close.screen(6)
## FIGURE 3: within vs outside distance ####
## number of iterations
iter = 1000
## set screens
split.screen(rbind(c(0, 0.5, 0.66, 1),
c(0, 0.5, 0.33, 0.66),
c(0, 0.5, 0, 0.33),
c(0.5, 1, 0.66, 1),
c(0.5, 1, 0.33, 0.66),
c(0.5, 1, 0, 0.33)))
## LANDOLTIA
## subset the ponds
landoltia_p10 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P10"),which(substr(colnames(landoltia_hamdist),1,3) == "P10")]
landoltia_p14 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P14"),which(substr(colnames(landoltia_hamdist),1,3) == "P14")]
landoltia_p19 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P19"),which(substr(colnames(landoltia_hamdist),1,3) == "P19")]
landoltia_p27 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P27"),which(substr(colnames(landoltia_hamdist),1,3) == "P27")]
landoltia_p36 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P36"),which(substr(colnames(landoltia_hamdist),1,3) == "P36")]
## calculate permutations
landoltia_perm_mean = vector()
landoltia_perm_clone = vector()
landoltia_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(landoltia_hamdist), 22)
runner_matrix = landoltia_hamdist[runner_sample,runner_sample]
landoltia_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
landoltia_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
landoltia_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,2,0.3,0.3))
screen(1)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", ylab="Genetic distance", las=2)
points(1, mean(landoltia_p10[lower.tri(landoltia_p10, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(2, mean(landoltia_p14[lower.tri(landoltia_p14, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(3, mean(landoltia_p19[lower.tri(landoltia_p19, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(4, mean(landoltia_p27[lower.tri(landoltia_p27, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(5, mean(landoltia_p36[lower.tri(landoltia_p36, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_mean, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_mean, probs = c(0.001, 0.999)))
close.screen(1)
## diversity plot
par(mar=c(0.3,2,0.3,0.3))
screen(2)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3.1), xlab="", main="", xaxt = "n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, diversity(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, diversity(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, diversity(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, diversity(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_diversity, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_diversity, probs = c(0.001, 0.999)))
close.screen(2)
## clones plot
par(mar=c(0.3,2,0.3,0.3))
screen(3)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, ncol(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, ncol(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, ncol(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, ncol(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_clone, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_clone, probs = c(0.001, 0.999)))
close.screen(3)
## LEMNA
## subset the ponds
lemna_p10 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P10"),which(substr(colnames(lemna_hamdist),1,3) == "P10")]
lemna_p14 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P14"),which(substr(colnames(lemna_hamdist),1,3) == "P14")]
lemna_p19 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P19"),which(substr(colnames(lemna_hamdist),1,3) == "P19")]
lemna_p27 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P27"),which(substr(colnames(lemna_hamdist),1,3) == "P27")]
lemna_p36 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P36"),which(substr(colnames(lemna_hamdist),1,3) == "P36")]
## calculate permutations
lemna_perm_mean = vector()
lemna_perm_clone = vector()
lemna_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(lemna_hamdist), 22)
runner_matrix = lemna_hamdist[runner_sample,runner_sample]
lemna_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
lemna_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
lemna_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,0.3,0.3,0.3))
screen(4)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", yaxt="n", ylab="Genetic distance", las=2)
points(1, mean(lemna_p10[lower.tri(lemna_p10, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(2, mean(lemna_p14[lower.tri(lemna_p14, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(3, mean(lemna_p19[lower.tri(lemna_p19, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(4, mean(lemna_p27[lower.tri(lemna_p27, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(5, mean(lemna_p36[lower.tri(lemna_p36, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_mean, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_mean, probs = c(0.001, 0.999)))
close.screen(4)
## diversity plot
par(mar=c(0.3,0.3,0.3,0.3))
screen(5)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3.1), xlab="", main="", xaxt = "n",  yaxt="n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, diversity(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, diversity(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, diversity(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, diversity(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_diversity, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_diversity, probs = c(0.001, 0.999)))
close.screen(5)
## clones plot
par(mar=c(0.3,0.3,0.3,0.3))
screen(6)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", yaxt="n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, ncol(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, ncol(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, ncol(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, ncol(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_clone, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_clone, probs = c(0.001, 0.999)))
close.screen(6)
## FIGURE 3: within vs outside distance ####
## number of iterations
iter = 1000
## set screens
split.screen(rbind(c(0, 0.5, 0.66, 1),
c(0, 0.5, 0.33, 0.66),
c(0, 0.5, 0, 0.33),
c(0.5, 1, 0.66, 1),
c(0.5, 1, 0.33, 0.66),
c(0.5, 1, 0, 0.33)))
## LANDOLTIA
## subset the ponds
landoltia_p10 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P10"),which(substr(colnames(landoltia_hamdist),1,3) == "P10")]
landoltia_p14 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P14"),which(substr(colnames(landoltia_hamdist),1,3) == "P14")]
landoltia_p19 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P19"),which(substr(colnames(landoltia_hamdist),1,3) == "P19")]
landoltia_p27 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P27"),which(substr(colnames(landoltia_hamdist),1,3) == "P27")]
landoltia_p36 = landoltia_hamdist[which(substr(colnames(landoltia_hamdist),1,3) == "P36"),which(substr(colnames(landoltia_hamdist),1,3) == "P36")]
## calculate permutations
landoltia_perm_mean = vector()
landoltia_perm_clone = vector()
landoltia_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(landoltia_hamdist), 22)
runner_matrix = landoltia_hamdist[runner_sample,runner_sample]
landoltia_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
landoltia_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
landoltia_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,5,0.3,0.3))
screen(1)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", ylab="Genetic distance", las=2)
points(1, mean(landoltia_p10[lower.tri(landoltia_p10, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(2, mean(landoltia_p14[lower.tri(landoltia_p14, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(3, mean(landoltia_p19[lower.tri(landoltia_p19, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(4, mean(landoltia_p27[lower.tri(landoltia_p27, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(5, mean(landoltia_p36[lower.tri(landoltia_p36, diag=FALSE)]), pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_mean, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_mean, probs = c(0.001, 0.999)))
close.screen(1)
## diversity plot
par(mar=c(0.3,5,0.3,0.3))
screen(2)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3.1), xlab="", main="", xaxt = "n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, diversity(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, diversity(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, diversity(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, diversity(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_diversity, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_diversity, probs = c(0.001, 0.999)))
close.screen(2)
## clones plot
par(mar=c(0.3,5,0.3,0.3))
screen(3)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(landoltia_p10)),pch=21, bg="purple", cex=2)
points(2, ncol(hamdist_to_rarecurve(landoltia_p14)),pch=21, bg="purple", cex=2)
points(3, ncol(hamdist_to_rarecurve(landoltia_p19)),pch=21, bg="purple", cex=2)
points(4, ncol(hamdist_to_rarecurve(landoltia_p27)),pch=21, bg="purple", cex=2)
points(5, ncol(hamdist_to_rarecurve(landoltia_p36)),pch=21, bg="purple", cex=2)
points(rep(6,iter), landoltia_perm_clone, pch=21, bg="purple", cex=2)
abline(h=quantile(landoltia_perm_clone, probs = c(0.001, 0.999)))
close.screen(3)
## LEMNA
## subset the ponds
lemna_p10 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P10"),which(substr(colnames(lemna_hamdist),1,3) == "P10")]
lemna_p14 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P14"),which(substr(colnames(lemna_hamdist),1,3) == "P14")]
lemna_p19 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P19"),which(substr(colnames(lemna_hamdist),1,3) == "P19")]
lemna_p27 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P27"),which(substr(colnames(lemna_hamdist),1,3) == "P27")]
lemna_p36 = lemna_hamdist[which(substr(colnames(lemna_hamdist),1,3) == "P36"),which(substr(colnames(lemna_hamdist),1,3) == "P36")]
## calculate permutations
lemna_perm_mean = vector()
lemna_perm_clone = vector()
lemna_perm_diversity = vector()
for (n in 1:iter) {
runner_sample = sample(colnames(lemna_hamdist), 22)
runner_matrix = lemna_hamdist[runner_sample,runner_sample]
lemna_perm_mean[n] = mean(runner_matrix[lower.tri(runner_matrix, diag=FALSE)])
lemna_perm_clone[n] = ncol(hamdist_to_rarecurve(runner_matrix))
lemna_perm_diversity[n] = diversity(hamdist_to_rarecurve(runner_matrix))
}
## mean plot
par(mar=c(0.3,0.3,0.3,0.3))
screen(4)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,0.2), xlab="", main="", xaxt = "n", yaxt="n", ylab="Genetic distance", las=2)
points(1, mean(lemna_p10[lower.tri(lemna_p10, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(2, mean(lemna_p14[lower.tri(lemna_p14, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(3, mean(lemna_p19[lower.tri(lemna_p19, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(4, mean(lemna_p27[lower.tri(lemna_p27, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(5, mean(lemna_p36[lower.tri(lemna_p36, diag=FALSE)]), pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_mean, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_mean, probs = c(0.001, 0.999)))
close.screen(4)
## diversity plot
par(mar=c(0.3,0.3,0.3,0.3))
screen(5)
plot(NULL, xlim=c(0.5,6.5), ylim=c(-0.1,3.1), xlab="", main="", xaxt = "n",  yaxt="n", ylab="Diversity (Shannon)", las=2)
points(1, diversity(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, diversity(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, diversity(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, diversity(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, diversity(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_diversity, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_diversity, probs = c(0.001, 0.999)))
close.screen(5)
## clones plot
par(mar=c(0.3,0.3,0.3,0.3))
screen(6)
plot(NULL, xlim=c(0.5,6.5), ylim=c(0,23), xlab="", main="", xaxt = "n", yaxt="n", ylab="Number of clones", las=2)
axis(1, at = 1:6, las=2, labels = c("P10", "P14", "P19", "P27", "P36", "perm"))
points(1, ncol(hamdist_to_rarecurve(lemna_p10)),pch=21, bg="darkgreen", cex=2)
points(2, ncol(hamdist_to_rarecurve(lemna_p14)),pch=21, bg="darkgreen", cex=2)
points(3, ncol(hamdist_to_rarecurve(lemna_p19)),pch=21, bg="darkgreen", cex=2)
points(4, ncol(hamdist_to_rarecurve(lemna_p27)),pch=21, bg="darkgreen", cex=2)
points(5, ncol(hamdist_to_rarecurve(lemna_p36)),pch=21, bg="darkgreen", cex=2)
points(rep(6,iter), lemna_perm_clone, pch=21, bg="darkgreen", cex=2)
abline(h=quantile(lemna_perm_clone, probs = c(0.001, 0.999)))
close.screen(6)
